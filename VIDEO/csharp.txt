public Frm_Main()
{
    InitializeComponent();
}

Process pyProcess;

private void btn_Run_Click(object sender, EventArgs e)
{
    string v_path = @"F:\9.Source_Code\Yolo11\DATASET\Video\2103099-uhd_3840_2160_30fps.mp4";
    string m_path = @"F:\9.Source_Code\Yolo11\PRETRAINED\Yolo11_Object_Detection\yolo11n.pt";

    string pythonPath = @"C:\Python312\python.exe";
    string scriptPath = @"F:\9.Source_Code\Yolo11\VIDEO\tracking.py";
    scriptPath += " \"" + v_path + "\" \"" + m_path + "\"";

    lb_Status.Text = "Initing...";

    pyProcess = new Process
    {
        StartInfo = new ProcessStartInfo
        {
            FileName = pythonPath,
            Arguments = scriptPath,
            UseShellExecute = false,
            RedirectStandardOutput = true, // Đọc output từ lệnh print()
            CreateNoWindow = true          // Chạy ngầm
        }
    };

    // Sự kiện nhận mỗi dòng Text từ Python print()
    pyProcess.OutputDataReceived += (s, args) =>
    {
        if (!string.IsNullOrEmpty(args.Data))
        {
            // Cập nhật lên giao diện
            this.Invoke(new MethodInvoker(delegate
            {
                if (args.Data == "Init_Done") lb_Status.Text = "Tracking...";
                rtb_Logs.AppendText(args.Data + "\r\n");
                rtb_Logs.ScrollToCaret();
            }));
        }
    };

    pyProcess.Start();
    pyProcess.BeginOutputReadLine();
}

private void Frm_Main_FormClosing(object sender, FormClosingEventArgs e)
{
    if (pyProcess != null && !pyProcess.HasExited)
    {
        pyProcess.Kill(); // Buộc dừng Python khi tắt App
    }
}